# 🗓️ 2025.07.30(수) – 교육 일지

## 📚 오늘 배운 내용
### Python for LLM
#### OpenAI API 호출 (chat/completions)
- 환경 변수 사용
  ```
  # .env 파일
  OPENAI_API_KEY=sk-xxxxxxxxxxxxx
  ```
  ```
  # .gitignore
  .env
  ```
  ```
  from dotenv import load_dotenv
  load_dotenv()
  api_key = os.getenv("OPENAI_API_KEY")
  ```
  - .env 파일에서 API 키를 안전하게 불러옴
  - load_dotenv()로 메모리에 환경 변수 로딩
- API 요청 설정
  ```
  api_url = "https://api.openai.com/v1/chat/completions"
  headers = {
    "Authorization": f"Bearer {api_key}",
    "Content-Type": "application/json"
  }
  data = {
    "model": "gpt-3.5-turbo",
    "messages": [
      {"role": "user", "content": "파이썬의 f-string에 대해 30자 이내로 설명해줘."}
    ],
    "temperature": 0.7
  }
  ```
  - messages: 대화형 모델에 전달할 내용
  - temperature: 창의성 조절 (0: 확정적, 2: 창의적)
- 요청 및 응답 처리
  ```
  response = requests.post(api_url, headers=headers, json=data)
  response.raise_for_status()  # 오류 응답 시 예외 발생
  result = response.json()
  ```
  - POST 요청으로 LLM에 질문 전달
  - 응답 결과를 JSON으로 파싱
- 결과(result) 예시
  ```
  {
    "model": "gpt-3.5-turbo",
    "choices": [
      {
        "message": {
          "content": "문자열 안에 변수 쉽게 삽입 가능"
        }
      }
    ]
  }
  ```
- 응답 출력
  ```
  answer = result['choices'][0]['message']['content']
  print("LLM의 답변 : ")
  print(answer)
  ```
- 사용된 라이브러리

  | 라이브러리      | 용도                |
  | ---------- | ----------------- |
  | `json`     | JSON 직렬화 및 역직렬화   |
  | `os`       | 환경 변수 접근          |
  | `dotenv`   | `.env` 파일에서 변수 로드 |
  | `requests` | HTTP 요청 처리        |

#### JSON 처리
- 파이썬 객체를 JSON 파일로 저장하기
  ```
  with open(output_filename, 'w', encoding='utf-8') as f:
    json.dump(structured_data, f, indent=2, ensure_ascii=False)
  ```
  - 'w' : 쓰기 모드 
  - json.dump(data, file): 파이썬 객체 → JSON 파일
  - indent: JSON 파일의 들여쓰기
  - ensure_ascii=False: 한글 깨짐 방지
  - try-catch 필수
- JSON 파일을 다시 파이썬 객체로 불러오기
  ```
  with open(output_filename, 'r', encoding='utf-8') as f:
    loaded_data = json.load(f)
  ```
  - 'r' : 읽기 모드
  - json.load(): JSON 파일 → 파이썬 객체
  - 예외 처리:
    - FileNotFoundError
    - json.JSONDecodeError
- CSV -> JSON 변환
  - CSV 파일을 JSONL(JSON Lines) 포맷으로 변환
  - 각 행(Row)을 하나의 JSON 오브젝트로 저장
  - 머신러닝 / API / 데이터 마이그레이션 등에 활용 가능
  - import pandas
    - 주요 자료구조
      - Series (1차원)
      - DataFrame (2차원, 엑셀 시트 같은 구조)
    - 주요 기능
      - CSV, Excel, JSON 등 다양한 파일 읽기/쓰기 (read_csv, to_csv 등)
      - 데이터 필터링, 정렬, 그룹화 (loc, sort_values, groupby)
      - 통계/수치 연산 (mean, sum, count)
      - 결측치 처리 (fillna, dropna)
  - CSV 파일 읽기
    ```
    df = pd.read_csv(csv_path, encoding="utf-8")
    ```
    - pandas의 read_csv()로 CSV → DataFrame 변환
    - encoding="utf-8" : 한글 파일 처리
  - DataFrame -> 딕셔너리 리스트 변환
    ```
    records = df.to_dict('records')
    ```
    - 각 행을 dict로 변환
  - JSONL 파일로 저장
    ```
    with open(jsonl_path, 'w', encoding='utf-8') as f:
    for record in records:
        json_string = json.dumps(record, ensure_ascii=False)
        f.write(json_string + '\n')
    ```
    - json.dumps() → dict → JSON 문자열 변환
    - ensure_ascii=False → 한글 깨짐 방지
    - \n 추가 → JSON Lines 포맷 유지
- JSON과 JSONL의 차이

    | 형식    | 예시                     | 특징                            |
    | ----- | ---------------------- | ----------------------------- |
    | JSON  | `[{"id":1}, {"id":2}]` | 한 개의 큰 배열                     |
    | JSONL | `{"id":1}\n{"id":2}`   | 줄마다 하나의 JSON 객체, 대용량/스트리밍에 유리 |

## ✍️ 오늘의 회고
- OPEN API를 사용하는 방법에 대해서 배웠다. langchain을 사용하게 되면 이러한 복잡한 과정이 없어진다고 한다.
- 다양한 파일의 형식(파이썬 객체, CSV 등)을 JSON으로 바꾸는 방법에 대해 알아봤다. CSV → JSON 변환은 데이터 가공/이동에 필수고, JSON ↔ 파이썬 딕셔너리 변환은 API 통신이나 파일 I/O에서 거의 무조건 쓴다고 한다!